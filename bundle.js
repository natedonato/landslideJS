!function(t){var e={};function i(s){if(e[s])return e[s].exports;var h=e[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,i),h.l=!0,h.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var h in t)i.d(s,h,function(e){return t[e]}.bind(null,h));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){(function(t){const e=i(2),s=i(5);t.env.SECRET_KEY;document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("game");if(null!==t){t.width=640,t.height=500,ctx=t.getContext("2d"),fetchScores();const i=new e(t.height,t.width);new s(i,ctx,t.height,t.width).start()}else{const t=document.getElementById("mobilegame");t.width=640,t.height=700,ctx=t.getContext("2d");const i=new e(t.height,t.width);new s(i,ctx,t.height,t.width).start()}}),fetchScores=t=>{document.getElementById("table").innerHTML="<tr>LOADING SCORES...</tr>",fetch("https://landslide.natedonato.com/api/scores").then(t=>t.json()).then(e=>{let i=e;t&&t.score<i[i.length-1].score&&10===i.length&&(i=i.concat(t));let s="";i.forEach(e=>{let i=new Date(e.date);i=i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear(),t&&e._id===t._id?s+=' <tr style="color: orange;" ><td>'+e.score+"</td><td>"+e.name+"</td><td>"+i+"</td></tr>":s+=" <tr><td>"+e.score+"</td><td>"+e.name+"</td><td>"+i+"</td></tr>"}),document.getElementById("table").innerHTML=s})},fetchPost=(t,e)=>{fetch("https://landslide.natedonato.com/api/scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,score:e,secretKey:"LC2crxs6iMZHNw9yUpyy"})}).then(t=>t.json()).then(t=>{fetchScores(t)})}}).call(this,i(1))},function(t,e){var i,s,h=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(t){s=n}}();var r,l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&g())}function g(){if(!c){var t=a(d);c=!0;for(var e=l.length;e;){for(r=l,l=[];++u<e;)r&&r[u].run();u=-1,e=l.length}r=null,c=!1,function(t){if(s===clearTimeout)return clearTimeout(t);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(t);try{s(t)}catch(e){try{return s.call(null,t)}catch(e){return s.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function m(){}h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new y(t,e)),1!==l.length||c||a(g)},y.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=m,h.addListener=m,h.once=m,h.off=m,h.removeListener=m,h.removeAllListeners=m,h.emit=m,h.prependListener=m,h.prependOnceListener=m,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,i){const s=i(3),h=i(4);t.exports=class{constructor(t,e){this.guyspeed=10,this.friction=.85,this.gravity=.3,this.guy=new h(t,e,this.guyspeed),this.minSize=80,this.maxSize=180,this.maxX=e,this.rockInterval=1e3,this.lastRock=2*this.rockInterval,this.rockAvgSpeed=2,this.rockSpeedVariation=.5,this.water={x:0,y:t+600,w:e,h:t+600,speed:.62},this.canvasheight=t,this.canvaswidth=e,this.maxrockheight=0,this.currHeight=0,this.maxHeight=0,this.rocks=[]}reset(){return this.rocks=[],this.maxrockheight=0,this.currHeight=190,this.maxHeight=0,this.lastRock=0,this.guy=new h(this.canvasheight,this.canvaswidth,this.guyspeed),this.water.y=this.canvasheight+500,this.guy}addRock(t){this.rocks.push(t)}rockGenerator(t){let e=this.maxrockheight;this.maxHeight+this.canvasheight>this.maxrockheight&&(e=this.maxHeight+this.canvasheight),Math.floor(this.maxHeight/10)<100?t-this.lastRock>2*this.rockInterval&&(this.lastRock=t-this.rockInterval/8+Math.random()*this.rockInterval/4,this.addRock(s.generate(this.minSize,this.maxSize,e,this.maxX,3*this.rockAvgSpeed/4,this.rockSpeedVariation))):t-this.lastRock>this.rockInterval&&(this.lastRock=t-this.rockInterval/8+Math.random()*this.rockInterval/4,this.addRock(s.generate(this.minSize,this.maxSize,e,this.maxX,this.rockAvgSpeed,this.rockSpeedVariation)))}checkRockCollision(t,e){if(t.pos.x<e.pos.x+e.width&&e.pos.x<t.pos.x+t.width&&t.pos.y<e.pos.y+e.height&&e.pos.y<t.pos.y+t.height)if(t.falling&&e.falling){let i=Math.min(t.rockspeed,e.rockspeed);t.rockspeed=i,e.rockspeed=i}else t.falling=!1,e.falling=!1,this.canvasheight-t.pos.y>this.maxrockheight&&(this.maxrockheight=this.canvasheight-t.pos.y)}checkPlayerCollision(t){let e="none",i=this.guy.pos.x+this.guy.width/2-(t.pos.x+t.width/2),s=this.guy.pos.y+this.guy.height/2-(t.pos.y+t.height/2),h=Math.abs(i),o=Math.abs(s),n=this.guy.width/2+t.width/2,a=this.guy.height/2+t.height/2;if(h<n&&o<a){let r,l,c=n-h,u=a-o;r=Math.abs(c/this.guy.vel.x),l=Math.abs(u/this.guy.vel.y),l<r||0===this.guy.vel.y&&!1===this.guy.airborne?s<=0?(e="top",this.guy.pos.y-=u,t.falling?this.guy.vel.y=t.rockspeed:this.guy.vel.y=1,this.guy.airborne=!1,this.guy.jumps=2):(e="bottom",!this.guy.airborne&&t.falling&&(this.guy.dead="crushed"),this.guy.pos.y+u>=this.canvasheight-this.guy.height?this.guy.pos.y=this.canvasheight-this.guy.height:(this.guy.pos.y+=u,this.guy.vel.y=t.rockspeed)):i>0?(e="right",this.guy.pos.x+=c,this.guy.wallcling=1):(e="left",this.guy.pos.x-=c,this.guy.wallcling=-1)}return e}checkWaterCollision(){this.guy.pos.y+this.guy.height>this.water.y&&(this.guy.dead="drowned")}updateWaterPos(t){Math.floor(this.maxHeight/10)<150?this.water.y-=this.water.speed*t/2:(this.water.y-=this.water.speed*t,this.water.y-this.guy.pos.y>700&&(this.water.y-=this.water.speed*t/2),this.water.y-this.maxrockheight>1e3&&(this.water.y-=this.water.speed*t)),this.checkWaterCollision()}updateRockPos(t){this.rocks.forEach(e=>{e.falling&&(e.pos.y+=e.rockspeed*t,e.pos.y+e.height>=this.canvasheight&&(e.pos.y=this.canvasheight-e.height,e.falling=!1),this.rocks.forEach(t=>{t!==e&&this.checkRockCollision(e,t)})),this.checkPlayerCollision(e)})}updateGuyPos(t){this.guy.vel.x*=this.friction,this.guy.vel.y+=this.gravity,0!==this.guy.wallcling&&this.guy.vel.y>0&&(this.guy.vel.y-=2*this.gravity/3),this.guy.vel.y>this.gravity+1&&(this.guy.airborne=!0,this.guy.jumps=0),this.guy.pos.x>this.canvaswidth-this.guy.width/2?this.guy.pos.x=-4:this.guy.pos.x<-this.guy.width/2&&(this.guy.pos.x=this.canvaswidth-this.guy.width/2-2),this.guy.pos.x+=this.guy.vel.x*t,this.guy.pos.y+=this.guy.vel.y*t,this.guy.pos.y>=this.canvasheight-this.guy.height&&(this.guy.pos.y=this.canvasheight-this.guy.height,this.guy.jumps=2,this.guy.airborne=!1,this.guy.vel.y=1),this.currHeight=500-this.guy.pos.y-this.guy.height,this.currHeight>this.maxHeight&&(this.maxHeight=this.currHeight),this.guy.wallcling=0}updatePos(t){isNaN(t)&&(t=1),this.updateGuyPos(t),this.updateRockPos(t),this.updateWaterPos(t)}step(t,e){this.rockGenerator(t),this.updatePos(e)}}},function(t,e){class i{constructor(t,e,i,s,h){this.pos={x:t,y:e},this.width=i,this.height=i,this.falling=!0,this.rockspeed=s-h/2+Math.random()*h}static generate(t,e,s,h,o,n){let a=t+Math.random()*(e-t),r=Math.random()*(h-a);return new i(r,-220-s,a,o,n)}}t.exports=i},function(t,e){t.exports=class{constructor(t,e,i){this.pos={x:t/2,y:e-50},this.vel={x:0,y:5},this.width=28,this.height=42,this.maxspeed=i,this.jumps=0,this.airborne=!0,this.dead=!1,this.wallcling=0}}},function(t,e){t.exports=class{constructor(t,e,i,s){this.game=t,this.paused=!0,this.ctx=e,this.guy=t.guy,this.keys={},this.canvasheight=i,this.canvaswidth=s,this.lastUpdated=0,this.water=t.water,this.jumpSound=new Audio("./soundfx/jump1.wav"),this.jumpSound.volume=.2,this.jumpSound2=new Audio("./soundfx/jump2.wav"),this.jumpSound2.volume=.3,this.waterSound=new Audio("./soundfx/drowned.wav"),this.crushSound=new Audio("./soundfx/crushed.wav"),this.crushSound.volume=.3,this.colorSound=new Audio("./soundfx/colorshift.wav"),this.colorSound.volume=.35,this.bgm=new Audio("./soundfx/Fantasies_of_Yonder.mp3"),this.bgm.volume=.35,this.bgm.loop=!0,this.gameEndHeight=0,this.tooSoon=!1,this.tooSoonMute=!1,this.bgcolor="#FFA500",this.rockcolor="#000000",this.playercolor="#ff1919",this.watercolor="blue",this.colorChangeHeight=500,this.colorChangeCurrent=this.colorChangeHeight,this.ctx.fillStyle=this.bgcolor,this.ctx.fillRect(0,0,this.game.canvaswidth,this.game.canvasheight)}bindkeys(){let t=this;document.getElementById("canvas");window.addEventListener("keydown",(function(e){37!==e.keyCode&&38!==e.keyCode&&39!==e.keyCode&&40!==e.keyCode&&13!==e.keyCode||e.preventDefault(),t.keys[e.keyCode]=!0})),window.addEventListener("keyup",(function(e){t.keys[e.keyCode]=!1}));let e=document.getElementById("jump-button");if(null!==e){e.addEventListener("touchstart",e=>{e.preventDefault(),t.keys.jump=!0});let i=document.getElementById("left"),s=document.getElementById("right");i.addEventListener("touchstart",e=>{e.preventDefault(),t.keys[37]=!0});let h=i.getClientRects()[0].right;i.addEventListener("touchmove",e=>{Math.min(Object.values(e.changedTouches).map(t=>t.clientX))>h&&(t.keys[37]=!1)}),i.addEventListener("touchend",e=>{e.preventDefault(),t.keys[39]=!1,t.keys[37]=!1});let o=s.getClientRects()[0].left;s.addEventListener("touchstart",e=>{e.preventDefault(),t.keys[39]=!0}),s.addEventListener("touchmove",e=>{e.changedTouches[0].clientX<o&&(t.keys[39]=!1)}),s.addEventListener("touchend",e=>{e.preventDefault(),t.keys[39]=!1,t.keys[37]=!1});document.getElementById("splash").addEventListener("touchend",e=>{this.closeMenu(),this.bgm.play(),t.keys[13]=!0});document.getElementById("menu").addEventListener("touchend",e=>{this.closeMenu(),this.bgm.play(),t.keys[13]=!0})}}openLeaderBoard(){this.leaderboard=!0,fetchScores();const t=document.getElementById("menu"),e=document.getElementById("leaderboard"),i=document.getElementsByClassName("post-form");for(let t=0;t<i.length;t++)i[t].style.display="table-row";t.style.display="none",e.style.display="flex";let s=this.gameEndHeight;document.getElementById("currscore").innerHTML=s;const h=document.getElementById("submit"),o=document.getElementById("close");h.addEventListener("click",t=>{let e=document.getElementById("name").value;for(let t=0;t<i.length;t++)i[t].style.display="none";fetchPost(e,s)}),o.addEventListener("click",i=>{t.style.display="flex",e.style.display="none",this.leaderboard=!1})}openMenu(){this.paused=!0;let t=document.getElementById("game");t&&(t.style.display="none");document.getElementById("menu").style.display="flex";const e=document.getElementById("height"),i=document.getElementById("death-info");e.innerHTML=String(this.gameEndHeight)+" ft","crushed"===this.guy.dead?i.innerHTML="(then you were crushed by a falling block)":"drowned"===this.guy.dead&&(i.innerHTML="(then you fell into the water and drowned)")}closeMenu(){let t=document.getElementById("game");t||(t=document.getElementById("mobilegame"));const e=document.getElementById("menu"),i=document.getElementById("splash");e.style.display="none",i.style.display="none",t.style.display="block",this.paused=!1}jump(){this.game.paused||(0!==this.guy.wallcling&&!0===this.guy.airborne&&!1===this.tooSoon?(this.jumpSound2.play(),this.tooSoon=!0,this.guy.vel.y=-8,this.guy.vel.x=6*this.guy.wallcling,setTimeout(()=>this.tooSoon=!1,300)):this.guy.jumps>0&&!1===this.tooSoon&&(this.jumpSound.play(),this.tooSoon=!0,2===this.guy.jumps?this.guy.vel.y=-8:this.guy.vel.y=-6,this.guy.airborne=!0,this.guy.jumps-=2,setTimeout(()=>this.tooSoon=!1,300)))}moveRight(){this.guy.vel.x<this.guy.maxspeed&&(this.guy.vel.x+=1)}moveLeft(){this.guy.vel.x>-this.guy.maxspeed&&(this.guy.vel.x-=1)}handleKeys(){this.keys.jump&&(this.jump(),this.keys.jump=!1),(this.keys[38]||this.keys[32]||this.keys[87])&&this.jump(),(this.keys[39]||this.keys[68])&&this.moveRight(),(this.keys[37]||this.keys[65])&&this.moveLeft(),this.keys[13]&&(this.reset(),this.keys[13]=!1),this.keys[76]&&this.paused&&this.openLeaderBoard(),this.keys[77]&&!1===this.tooSoonMute&&(this.tooSoonMute=!0,.35===this.bgm.volume?(this.bgm.volume=0,this.bgm.pause()):(this.bgm.volume=.35,this.bgm.play()),setTimeout(()=>this.tooSoonMute=!1,300))}handleDeath(){this.gameEndHeight=Math.floor(this.game.maxHeight/10),"drowned"===this.guy.dead?this.waterSound.play():"crushed"===this.guy.dead&&this.crushSound.play(),this.bgm.pause(),this.openMenu()}reset(){this.guy=this.game.reset(),this.colorChangeCurrent=this.colorChangeHeight,this.bgcolor="#FFA500",this.closeMenu(),this.bgm.currentTime=0,this.bgm.play(),this.paused=!1}drawGuy(t){if(!this.guy.dead){this.ctx.fillStyle=this.playercolor,this.ctx.save(),this.ctx.translate(this.guy.pos.x+this.guy.width/2-4*this.guy.wallcling,this.guy.pos.y+this.guy.height),0===this.guy.wallcling?this.ctx.rotate(2*this.guy.vel.x*Math.PI/180):this.ctx.rotate(12*this.guy.wallcling*Math.PI/180);let e=this.guy.width,i=this.guy.height;if(this.guy.airborne){let t=this.guy.vel.y;t>6&&(t=6),i-=t,t>2&&(t=2),e+=t}this.ctx.fillRect(-e/2,-i,e,i),this.ctx.restore(),this.ctx.fillStyle="#ffffff",this.ctx.textAlign="end",this.ctx.font="30px Arial",this.ctx.fillText(Math.floor(this.game.maxHeight/10)+" ft",this.canvaswidth-10,35-t),this.ctx.font="10px Arial",this.ctx.fillText(Math.floor(this.game.currHeight/10)+" ft",this.canvaswidth-10-2,50-t)}}drawRocks(){this.game.rocks.forEach(t=>{this.ctx.fillStyle=this.rockcolor,this.ctx.fillRect(t.pos.x,t.pos.y,t.width,t.height+1),this.ctx.fillStyle=this.bgcolor,this.ctx.beginPath(),this.ctx.arc(t.pos.x+t.width/2,t.pos.y+t.width/2,t.width/2*.7,0,2*Math.PI),this.ctx.fill()})}drawWater(){this.ctx.globalAlpha=.5,this.ctx.fillStyle=this.watercolor,this.ctx.fillRect(this.water.x,this.water.y,this.water.w,this.water.h),this.ctx.globalAlpha=1}draw(){if(this.game.maxHeight>this.colorChangeCurrent){this.colorSound.play(),this.colorChangeCurrent+=this.colorChangeHeight;let t=290*Math.random()+20;this.bgcolor="hsl("+t+",100%, 50%)","white"===this.rockcolor?this.rockcolor="black":this.rockcolor="white"}this.ctx.save();let t=this.game.currHeight-190;this.ctx.translate(0,t),this.ctx.clearRect(0,0-t,this.canvaswidth,this.canvasheight),this.ctx.fillStyle=this.bgcolor,this.ctx.fillRect(0,0-t,this.canvaswidth,this.canvasheight),this.drawRocks(),this.drawWater(),this.drawGuy(t),this.ctx.fillStyle="#000000",this.ctx.fillRect(0,this.canvasheight,2*this.canvaswidth/3,500),this.ctx.fillRect(2*this.canvaswidth/3+5,this.canvasheight,1*this.canvaswidth/3,500),this.ctx.restore()}start(){this.bindkeys(),this.update(0)}update(t){const e=(t-this.lastUpdated)/10;!0!==this.leaderboard&&this.handleKeys(),!0!==this.paused&&(this.game.step(t,e),this.guy.dead&&this.handleDeath(),this.draw()),this.lastUpdated=t,requestAnimationFrame(this.update.bind(this))}}}]);